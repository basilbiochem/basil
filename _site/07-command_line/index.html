















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2019-03-06 17:05:53 -0500">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - Scientific Programming for Computational Molecular Science"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Scientific Programming for Computational Molecular Science: Running code from the Linux Command Line</title>
  </head>
  <body>

    


<div class="panel panel-default life-cycle">
  <div id="life-cycle" class="panel-body pre-alpha">
    This lesson is still being designed and assembled (Pre-Alpha version)
  </div>
</div>





    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      <a href="http://molssi.org/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/molssi_main_logo.png" alt="The Molecular Sciences Software Institute" />
      </a>

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-introduction/index.html">Introduction</a></li>
            
            <li><a href="../02-file_parsing/index.html">File Parsing</a></li>
            
            <li><a href="../03-multiple_files/index.html">Processing Multiple Files and Writing Files</a></li>
            
            <li><a href="../04-tabular_data/index.html">Working with Tabular Data</a></li>
            
            <li><a href="../05-plotting/index.html">Plotting and Data Visualization</a></li>
            
            <li><a href="../06-functions/index.html">Writing Functions</a></li>
            
            <li><a href="../07-command_line/index.html">Running code from the Linux Command Line</a></li>
            
            <li><a href="../08-testing/index.html">Testing Code</a></li>
            
            <li><a href="../09-git/index.html">Version Control and Sharing Code</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/index.html">About</a></li>
            
            <li><a href="../discuss/index.html">Discussion</a></li>
            
            <li><a href="../figures/index.html">Figures</a></li>
            
            <li><a href="../guide/index.html">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="/edit//_episodes/07-command_line.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../06-functions/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Scientific Programming for Computational Molecular Science</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../08-testing/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Running code from the Linux Command Line</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 15 min
      <br/>
      <strong>Exercises:</strong> 10 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I move my code from the interactive jupyter notebook to run from the Linux command line?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Make code executable from the Linux command line.</p>
</li>
	
	<li><p>Use sys.argv() to accept user inputs.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="creating-and-running-a-python-input-file">Creating and running a python input file</h2>

<p>We are now going to move our geometry analysis code out of the jupyter notebook and into a format that can be run from the Linux command line.  Open your favorite text editor and create a new file called “geom_analysis.py” (or choose another filename, just make sure the extension is .py).  Paste in your geometry analysis code (the version with your functions) from your jupyter notebook and save your file.</p>

<p>The best practice is to put all your functions at the top of the file, right after your import statements.  Your file will look something like this.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">bond_length</span><span class="p">(</span><span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">):</span>
    <span class="n">BL</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">atom1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atom1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atom1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">BL</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">BL</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">BL</span>

<span class="k">def</span> <span class="nf">bond_check</span><span class="p">(</span><span class="n">bond_distance</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bond_distance</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">bond_distance</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>

<span class="n">xyz_file</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s">'water.xyz'</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'unicode'</span><span class="p">)</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">numA</span><span class="p">,</span> <span class="n">atomA</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">numB</span><span class="p">,</span> <span class="n">atomB</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
       <span class="n">BL_AB</span> <span class="o">=</span> <span class="n">bond_length</span><span class="p">(</span><span class="n">atomA</span><span class="p">,</span> <span class="n">atomB</span><span class="p">)</span>
       <span class="k">if</span> <span class="n">bond_check</span><span class="p">(</span><span class="n">BL_AB</span><span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
           <span class="k">print</span><span class="p">(</span><span class="n">F</span><span class="s">'{symbols[numA]} to {symbols[numB]} : {BL_AB}'</span><span class="p">)</span>
</code></pre></div></div>

<p>Exit your text editor and go back to the command line.  Now all you have to do to run your code is type</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python geom_analysis.py
</code></pre></div></div>
<p>in your Terminal window.  Your code should either print the output to the screen or write it to a file, depending on what you have it set up to do.</p>

<h2 id="changing-your-code-to-accept-user-inputs">Changing your code to accept user inputs</h2>
<p>In your current code, the name of the xyzfile to analyze, “water.xyz”, is hardcoded; in order to change it, you have to open your code and change the name of the file that is read in.  If you were going to use this code to analyze geometries in your research, you would probably want to be able to specify the name of the input file when you run the code, so that you don’t have to change it every single time.  These types of user inputs are called <em>arguments</em> and to make our code accept arguments, we have to import a new python library in our code.</p>

<p>Open your geometry analysis code in your text editor and add this line at the top.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys
</code></pre></div></div>

<p>Now that you have imported the <code class="highlighter-rouge">sys</code> library, you can use its functions.  The library has a function called <code class="highlighter-rouge">sys.argv()</code> which creates a list of all the arguments the user enters at the command line.  Everything after <em>python</em> is an argument, so <code class="highlighter-rouge">sys.argv[0]</code> is always the name of your script.  We would like our code to accept the name of the xyz file we want to analyze as an argument.  Add this line to your code.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<p>Then you need to go the part of your code where you read in the data from the xyz file and change the name of the file to read to <code class="highlighter-rouge">filename</code>.</p>
<div class="language highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xyz_file = numpy.genfromtxt(fname=filename, skip_header=2, dtype='unicode')
</code></pre></div></div>

<p>Save your code and go back to the Terminal window.  Make sure you are in the directory where your code is saved and type</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python geom_analysis.py water.xyz
</code></pre></div></div>
<p>Check that the output of your code is what you expected.</p>

<p>What would happen if the user forgot to specify the name of the xyz file?  The way the code is written now, it would give an error message.</p>
<div class="error highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Traceback (most recent call last):
  File "geom_analysis_2.py", line 13, in &lt;module&gt;
    filename = sys.argv[1]
IndexError: list index out of range
</code></pre></div></div>
<p>The reason it says the list index is out of range is because <code class="highlighter-rouge">sys.argv[1]</code> does not exist.  Since the user forgot to specify the name of the xyz file, the <code class="highlighter-rouge">sys.argv</code> array only has one element, <code class="highlighter-rouge">sys.argv[0]</code>.  It would be better to print an error message and let the user know that they didn’t enter the input correctly.  Our code is expecting exactly two inputs: the script name and the xyz file name. The easiest way to add an error message is to check the length of the sys.argv list and print an error message and exit if it does not equal the expected length.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'Incorrect input! Please try again.'</span><span class="p">)</span>
        <span class="nb">exit</span><span class="p">()</span>
</code></pre></div></div>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>You must <code class="highlighter-rouge">import sys</code> in your code to accept user arguments.</p>
</li>
    
    <li><p>The name of the script itself is always <code class="highlighter-rouge">sys.argv[0]</code> so the first user input is normally <code class="highlighter-rouge">sys.argv[1]</code>.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../06-functions/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../08-testing/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
        Copyright &copy; 2018–2019
	<a href="http://molssi.org">The Molecular Sciences Software Institute</a>
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="/edit/gh-pages/_episodes/07-command_line.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="mailto:education@molssi.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.0">9.5.0</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
