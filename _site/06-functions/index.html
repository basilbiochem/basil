















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2019-03-06 17:05:53 -0500">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - Scientific Programming for Computational Molecular Science"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Scientific Programming for Computational Molecular Science: Writing Functions</title>
  </head>
  <body>

    


<div class="panel panel-default life-cycle">
  <div id="life-cycle" class="panel-body pre-alpha">
    This lesson is still being designed and assembled (Pre-Alpha version)
  </div>
</div>





    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      <a href="http://molssi.org/" class="pull-left">
        <img class="navbar-logo" src="../assets/img/molssi_main_logo.png" alt="The Molecular Sciences Software Institute" />
      </a>

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-introduction/index.html">Introduction</a></li>
            
            <li><a href="../02-file_parsing/index.html">File Parsing</a></li>
            
            <li><a href="../03-multiple_files/index.html">Processing Multiple Files and Writing Files</a></li>
            
            <li><a href="../04-tabular_data/index.html">Working with Tabular Data</a></li>
            
            <li><a href="../05-plotting/index.html">Plotting and Data Visualization</a></li>
            
            <li><a href="../06-functions/index.html">Writing Functions</a></li>
            
            <li><a href="../07-command_line/index.html">Running code from the Linux Command Line</a></li>
            
            <li><a href="../08-testing/index.html">Testing Code</a></li>
            
            <li><a href="../09-git/index.html">Version Control and Sharing Code</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../about/index.html">About</a></li>
            
            <li><a href="../discuss/index.html">Discussion</a></li>
            
            <li><a href="../figures/index.html">Figures</a></li>
            
            <li><a href="../guide/index.html">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="/edit//_episodes/06-functions.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../05-plotting/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Scientific Programming for Computational Molecular Science</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../07-command_line/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Writing Functions</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> ?? min
      <br/>
      <strong>Exercises:</strong> ?? min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I write include functions in my code?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>First objective goes here.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="function">Function</h2>

<p>Most code is organized into blocks of code which perform a particular task.  These code blocks are called <em>functions</em>.  A commercial software package likely has hundreds of thousands or millions of functions. Functions break up our code into smaller, more easily understandable statements, and also allow our code to be more <em>modular</em>, meaning we can take pieces and reuse them. Functions also make your code easier to test, which we will see in a later lesson.</p>

<p>In general, each function should perform only one computational task.</p>

<h2 id="defining-and-running-a-function">Defining and running a function</h2>

<p>In Python, the following syntax is used to declare a function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">function_name</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
  <span class="o">**</span> <span class="n">function</span> <span class="n">body</span> <span class="n">code</span> <span class="o">**</span>
</code></pre></div></div>

<p>Functions are defined using the <code class="highlighter-rouge">def</code> keyword, followed by the name of the function. The function may have parameters which are passed to it, which are in parenthesis following the function name. A function can have no parameters as well. It is important to note here that defining a function does not execute it. Consider the following example with no parameters.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">print_hello</span><span class="p">():</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"Hello!"</span><span class="p">)</span>
</code></pre></div></div>

<p>We then call the function in the next cell</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print_hello</span><span class="p">()</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello!
</code></pre></div></div>

<h2 id="writing-functions-into-our-geometry-analysis-project">Writing functions into our geometry analysis project</h2>

<p>Let’s go back and consider a simple solution for the geometry analysis project.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">xyz_file</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="s">'water.xyz'</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'unicode'</span><span class="p">)</span>
<span class="n">symbols</span> <span class="o">=</span> <span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="nb">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">numA</span><span class="p">,</span> <span class="n">atomA</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">numB</span><span class="p">,</span> <span class="n">atomB</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
       <span class="k">if</span> <span class="n">numB</span> <span class="o">&gt;</span> <span class="n">numA</span><span class="p">:</span>
           <span class="n">bond_length_AB</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">atomA</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">atomB</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atomA</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">atomB</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atomA</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">atomB</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

           <span class="k">if</span> <span class="n">bond_length_AB</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">bond_length_AB</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">:</span>
               <span class="k">print</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="n">numA</span><span class="p">],</span> <span class="s">"to"</span><span class="p">,</span> <span class="n">symbols</span><span class="p">[</span><span class="n">numB</span><span class="p">],</span> <span class="s">":"</span><span class="p">,</span> <span class="n">bond_length_AB</span><span class="p">)</span>
</code></pre></div></div>

<p>To think about where we should write functions in this code, let’s think about parts we may want to use again or in other places. One of the first places we might think of is in the bond distance calculation. Perhaps we’d want to calculate a bond distance in some other script. We can reduce the likelihood of errors in our code by defining this in a function (so that if we wanted to change our bond calculation, we would only have to do it in one place.)</p>

<p>Let’s change this code so that we write a function to calculate the bond distance. As explained above, to define a function, you start with the word <code class="highlighter-rouge">def</code> and then give the name of the function.  In parenthesis are in inputs of the function followed by a colon.  The the statements the function is going to execute are indented on the next lines. For this function, we will <code class="highlighter-rouge">return</code> a value. The last line of a function shows the return value for the function, which we can use to store a variable with the output value.  Let’s write a function to calculate the distance between atoms.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">calculate_distance</span><span class="p">(</span><span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">):</span>
    <span class="n">bond_length</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">atom1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atom1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atom1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bond_length</span>
</code></pre></div></div>

<p>Now we can change our <code class="highlighter-rouge">for</code> loop to just call the distance function we wrote above.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">numA</span><span class="p">,</span> <span class="n">atomA</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">numB</span><span class="p">,</span> <span class="n">atomB</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
       <span class="k">if</span> <span class="n">numB</span> <span class="o">&gt;</span> <span class="n">numA</span><span class="p">:</span>
           <span class="n">bond_length_AB</span> <span class="o">=</span> <span class="n">calculate_distance</span><span class="p">(</span><span class="n">atomA</span><span class="p">,</span> <span class="n">atomB</span><span class="p">)</span>
           <span class="k">print</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="n">numA</span><span class="p">],</span> <span class="s">"to"</span><span class="p">,</span> <span class="n">symbols</span><span class="p">[</span><span class="n">numB</span><span class="p">],</span> <span class="s">":"</span><span class="p">,</span> <span class="n">bond_length_AB</span><span class="p">)</span>
</code></pre></div></div>

<p>Next, let’s write another function that checks to see if a particular bond distance represents a bond. This function will be called <code class="highlighter-rouge">bond_check</code>, and will return <code class="highlighter-rouge">True</code> if the bond distance is within certain bounds (At first we’ll set this to be between 0 and 1.5 angstroms).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bond_check</span><span class="p">(</span><span class="n">atom_distance</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">atom_distance</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">atom_distance</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
</code></pre></div></div>

<p>This is great! Our function will currently return <code class="highlighter-rouge">True</code> if our bond distance is less than 1.5 angstrom.</p>

<blockquote class="challenge">
  <h2 id="exercise">Exercise</h2>

  <p>Modify the <code class="highlighter-rouge">bond_check</code> function to take a minimum length and a maximum length as user input.</p>
  <blockquote class="solution">
    <h2 id="answer">Answer</h2>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bond_check</span><span class="p">(</span><span class="n">atom_distance</span><span class="p">,</span> <span class="n">minimum_length</span><span class="p">,</span> <span class="n">maximum_length</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">atom_distance</span> <span class="o">&gt;</span> <span class="n">minimum_length</span> <span class="ow">and</span> <span class="n">bond_distance</span> <span class="o">&lt;=</span> <span class="n">maximum_length</span><span class="p">:</span>
       <span class="k">return</span> <span class="bp">True</span>
   <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="bp">False</span>
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<h3 id="function-default-arguments">Function Default arguments</h3>
<p>When there are parameters in a function definition, we can set these parameters to default values. For example, if we want the default values in bond check to be 0 and 1.5, we can change the function definition to the following:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bond_check</span><span class="p">(</span><span class="n">atom_distance</span><span class="p">,</span> <span class="n">minimum_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum_length</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">atom_distance</span> <span class="o">&gt;</span> <span class="n">minimum_length</span> <span class="ow">and</span> <span class="n">atom_distance</span> <span class="o">&lt;=</span> <span class="n">maximum_length</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
</code></pre></div></div>

<p>Let’s try out the function now.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">bond_check</span><span class="p">(</span><span class="mf">1.5</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">bond_check</span><span class="p">(</span><span class="mf">1.6</span><span class="p">))</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True
False
</code></pre></div></div>

<p>However, we can overwrite <code class="highlighter-rouge">minimum_length</code> or <code class="highlighter-rouge">maximum_length</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">bond_check</span><span class="p">(</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">maximum_length</span><span class="o">=</span><span class="mf">1.6</span><span class="p">))</span>
</code></pre></div></div>

<p>Now that we have our <code class="highlighter-rouge">bond_check</code> function, we can use it in our <code class="highlighter-rouge">for</code> loop to only print the bond lengths that are really bonds.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">numA</span><span class="p">,</span> <span class="n">atomA</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">numB</span><span class="p">,</span> <span class="n">atomB</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
       <span class="k">if</span> <span class="n">numB</span> <span class="o">&gt;</span> <span class="n">numA</span><span class="p">:</span>
           <span class="n">bond_length_AB</span> <span class="o">=</span> <span class="n">atom_distance</span><span class="p">(</span><span class="n">atomA</span><span class="p">,</span> <span class="n">atomB</span><span class="p">)</span>
           <span class="k">if</span> <span class="n">bond_check</span><span class="p">(</span><span class="n">bond_length_AB</span><span class="p">):</span>
               <span class="k">print</span><span class="p">(</span><span class="n">F</span><span class="s">'{symbols[numA]} to {symbols[numB]} : {bond_length_AB}'</span><span class="p">)</span>
</code></pre></div></div>
<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>O to H1 : 0.969
O to H2 : 0.969
</code></pre></div></div>

<blockquote class="challenge">
  <h2 id="exercise-1">Exercise</h2>

  <p>We might also want to write a function that opens and processes our <code class="highlighter-rouge">xyz</code> file for us. Write a function called open_xyz which takes an xyz file as a parameter and returns the symbols and coordinates.</p>

  <p><strong>Hint</strong>: You can return two values from a function by typing <code class="highlighter-rouge">return variable1, variable2</code>.</p>
  <blockquote class="solution">
    <h2 id="answer-1">Answer</h2>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">open_xyz</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
     <span class="n">xyz_file</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'unicode'</span><span class="p">)</span>
     <span class="n">symbols</span> <span class="o">=</span> <span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
     <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span>
     <span class="n">coord</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="nb">float</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">coord</span>
</code></pre></div>    </div>
  </blockquote>
</blockquote>

<p>We’ve now written three functions. Using these functions, our script to print bonded atoms now looks like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">symbols</span><span class="p">,</span> <span class="n">coord</span> <span class="o">=</span> <span class="n">open_xyz</span><span class="p">(</span><span class="s">'water.xyz'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">numA</span><span class="p">,</span> <span class="n">atomA</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">numB</span><span class="p">,</span> <span class="n">atomB</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
       <span class="k">if</span> <span class="n">numB</span> <span class="o">&gt;</span> <span class="n">numA</span><span class="p">:</span>
           <span class="n">bond_length_AB</span> <span class="o">=</span> <span class="n">calculate_distance</span><span class="p">(</span><span class="n">atomA</span><span class="p">,</span> <span class="n">atomB</span><span class="p">)</span>

           <span class="k">if</span> <span class="n">bond_check</span><span class="p">(</span><span class="n">bond_length_AB</span><span class="p">):</span>
               <span class="k">print</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="n">numA</span><span class="p">],</span> <span class="s">"to"</span><span class="p">,</span> <span class="n">symbols</span><span class="p">[</span><span class="n">numB</span><span class="p">],</span> <span class="s">":"</span><span class="p">,</span> <span class="n">bond_length_AB</span><span class="p">)</span>
</code></pre></div></div>

<p>You can probably think of a further extension to use functions here. What if we wanted to print the bonds for another <code class="highlighter-rouge">xyz</code> file besides water? One option would be to copy and paste the two two <code class="highlighter-rouge">for</code> loops we’ve written. However, the smarter move is to put them in a function.</p>

<p>We could encapsulate the <code class="highlighter-rouge">for</code> loops into a function as well. Let’s do this, then perform the same analysis using both the <code class="highlighter-rouge">water.xyz</code> file and the <code class="highlighter-rouge">benzene.xyz</code> file.</p>

<p>First, we will define a new function <code class="highlighter-rouge">print_bonds</code>, which takes bond symbols and coordinates from an <code class="highlighter-rouge">xyz</code> file as an input.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def print_bonds(atom_symbols, atom_coordinates):
    for numA, atomA in enumerate(atom_coordinates):
        for numB, atomB in enumerate(atom_coordinates):
            if numB &gt; numA:
                bond_length_AB = calculate_distance(atomA, atomB)

                if bond_check(bond_length_AB):
                    print(atom_symbols[numA], "to", atom_symbols[numB], ":", bond_length_AB)
</code></pre></div></div>

<p>If you were to put all the functions we wrote into a single cell, it looks like this</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">calculate_distance</span><span class="p">(</span><span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">):</span>
    <span class="n">bond_length</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">atom1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atom1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">atom1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">atom2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bond_length</span>

<span class="k">def</span> <span class="nf">bond_check</span><span class="p">(</span><span class="n">atom_distance</span><span class="p">,</span> <span class="n">minimum_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum_length</span><span class="o">=</span><span class="mf">1.5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">atom_distance</span> <span class="o">&gt;</span> <span class="n">minimum_length</span> <span class="ow">and</span> <span class="n">atom_distance</span> <span class="o">&lt;=</span> <span class="n">maximum_length</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">open_xyz</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">xyz_file</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'unicode'</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="n">xyz_file</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">coord</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">coord</span>

<span class="k">def</span> <span class="nf">print_bonds</span><span class="p">(</span><span class="n">atom_symbols</span><span class="p">,</span> <span class="n">atom_coordinates</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">numA</span><span class="p">,</span> <span class="n">atomA</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atom_coordinates</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">numB</span><span class="p">,</span> <span class="n">atomB</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atom_coordinates</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">numB</span> <span class="o">&gt;</span> <span class="n">numA</span><span class="p">:</span>
                <span class="n">bond_length_AB</span> <span class="o">=</span> <span class="n">cacluate_distance</span><span class="p">(</span><span class="n">atomA</span><span class="p">,</span> <span class="n">atomB</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">bond_check</span><span class="p">(</span><span class="n">bond_length_AB</span><span class="p">):</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">atom_symbols</span><span class="p">[</span><span class="n">numA</span><span class="p">],</span> <span class="s">"to"</span><span class="p">,</span> <span class="n">atom_symbols</span><span class="p">[</span><span class="n">numB</span><span class="p">],</span> <span class="s">":"</span><span class="p">,</span> <span class="n">bond_length_AB</span><span class="p">)</span>
</code></pre></div></div>

<p>We can now open an arbitrary <code class="highlighter-rouge">xyz</code> file and print the bonded atoms. For example, to do this for water and benze, we could execute a cell like this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">water_symbols</span><span class="p">,</span> <span class="n">water_coords</span> <span class="o">=</span> <span class="n">open_xyz</span><span class="p">(</span><span class="s">'water.xyz'</span><span class="p">)</span>

<span class="n">benzene_symbols</span><span class="p">,</span> <span class="n">benzene_coords</span> <span class="o">=</span> <span class="n">open_xyz</span><span class="p">(</span><span class="s">'benzene.xyz'</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Printing bonds for water"</span><span class="p">)</span>
<span class="n">print_bonds</span><span class="p">(</span><span class="n">water_symbols</span><span class="p">,</span> <span class="n">water_coords</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Printing bonds for Benzene"</span><span class="p">)</span>
<span class="n">print_bonds</span><span class="p">(</span><span class="n">benzene_symbols</span><span class="p">,</span> <span class="n">benzene_coords</span><span class="p">)</span>
</code></pre></div></div>

<div class="output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Printing bonds for water
O to H1 : 0.9690005374652793
O to H2 : 0.9690003348647513
Printing bonds for Benzene
C to C : 1.3960247132483008
C to C : 1.3960247132483008
C to H : 1.0830000000000002
C to C : 1.396
C to H : 1.0833318974349455
C to C : 1.3960247132483008
C to H : 1.0833318974349455
C to C : 1.3960247132483008
C to H : 1.0830000000000002
C to C : 1.396
C to H : 1.0833318974349455
C to H : 1.0833318974349455
</code></pre></div></div>

<blockquote class="challenge">
  <h2 id="extension">Extension</h2>

  <p>In earlier lessons, we used <code class="highlighter-rouge">glob</code> to process multiple files. How could you use <code class="highlighter-rouge">glob</code> to print bonds for all the xyz files?</p>

  <blockquote class="solution">
    <h2 id="solution">Solution</h2>
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">glob</span>

<span class="n">xyz_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s">"data/*.xyz"</span><span class="p">)</span>

<span class="k">for</span> <span class="n">xyz_file</span> <span class="ow">in</span> <span class="n">xyz_files</span><span class="p">:</span>
   <span class="n">atom_symbols</span><span class="p">,</span> <span class="n">atom_coords</span> <span class="o">=</span> <span class="n">open_xyz</span><span class="p">(</span><span class="n">xyz_file</span><span class="p">)</span>
   <span class="k">print</span><span class="p">(</span><span class="s">"Printing bonds for "</span><span class="p">,</span> <span class="n">xyz_file</span><span class="p">)</span>
   <span class="n">print_bonds</span><span class="p">(</span><span class="n">atom_symbols</span><span class="p">,</span> <span class="n">atom_coords</span><span class="p">)</span>
</code></pre></div>    </div>
  </blockquote>
</blockquote>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>First point goes here.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../05-plotting/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../07-command_line/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
        Copyright &copy; 2018–2019
	<a href="http://molssi.org">The Molecular Sciences Software Institute</a>
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="/edit/gh-pages/_episodes/06-functions.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="mailto:education@molssi.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.0">9.5.0</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
